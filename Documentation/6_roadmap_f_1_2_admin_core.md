# 5 • Roadmap Admin Core (39 prompts CursorAI)

**Format JSON extins** – câmpuri obligatorii:
• `step` – index original (păstrăm 225-263 pentru trasabilitate)
• `scope` – sub-sistem vizat (max 3-4 cuvinte)
• `context` – livrări anterioare relevante
• `task` – instrucțiune imperativă clară
• `dirs` – listează directoarele vizate
• `constraints` – reguli stricte (commit-msg, chmod, etc.)
• `output` – rezultat așteptat

Structura respectă identic convențiile din **F0** și **F1**; nu introduce termene, doar ordinea logică.

## Umbrella - Dependencies & Context F1

| Interval | Effort | Scop/Componente | Layer | Dependințe F0 |
|----------|--------|-----------------|-------|----------------|
| 1‑4 | 1 SW | Event Bus RMQ namespaces & conventions v1 | infra | **0‑20, 33** |

```json
[
  {"step":225,"scope":"admin-core-skel","context":"Admin Core inexistent.","task":"`scripts/create-module.ts` generează `admin-core` (frontend, api, workers).","dirs":["/core/apps/admin-core/{frontend,api}/"],"constraints":"commit 'feat(admin-core): skeleton'.","output":"module skeleton"},
  {"step":226,"scope":"admin-db-migrations","context":"PG schema lipsă.","task":"Creează migrations TypeORM tabele `settings`, `roles`, `themes`.","dirs":["/core/apps/admin-core/api/src/migrations/"],"constraints":"include tid,whid.","output":"migrations SQL"},
  {"step":227,"scope":"admin-rbac-service","context":"Tabele create.","task":"Serviciu NestJS `RbacService` CRUD roluri + scope uri.","dirs":["/core/apps/admin-core/api/src/"],"constraints":"unit tests 80%.","output":"serviciu RBAC"},
  {"step":228,"scope":"admin-settings-api","context":"Settings table există.","task":"Controller `SettingsController` GET/PUT tenant-scoped.","dirs":["/core/apps/admin-core/api/src/controllers/"],"constraints":"Guard tid.","output":"API settings"},
  {"step":229,"scope":"admin-theme-api","context":"Theme Hub table.","task":"Endpoint `/themes` POST → validate JSON tokens.","dirs":["/core/apps/admin-core/api/src/"],"constraints":"payload 50KB max.","output":"API themes"},
  {"step":230,"scope":"admin-dtos","context":"Validare lipsă.","task":"Define DTO cu `class-validator`, pipe global validation.","dirs":["/core/apps/admin-core/api/src/dto/"],"constraints":"no any.","output":"DTO stricte"},
  {"step":231,"scope":"admin-auth-guard","context":"JWT guard generic.","task":"Extinde AuthGuard pentru claims `scp` + `role`.","dirs":["/core/apps/admin-core/api/src/guards/"],"constraints":"unit tested.","output":"guard RBAC"},
  {"step":232,"scope":"admin-configmap","context":"Valori default.","task":"Helm `ConfigMap` `admin-defaults` + `ExternalSecret admin-theme` din SecretsManager","dirs":["/infra/helm/admin-core/","/infra/k8s/"],"constraints":"ESO gata (step 41).","output":"ConfigMap + secret sync"},
  {"step":233,"scope":"admin-unit-tests","context":"Coverage sub 80%.","task":"Adaugă teste servicii Settings & Rbac.","dirs":["/core/apps/admin-core/api/"],"constraints":"","output":"coverage 85%"},
  {"step":234,"scope":"admin-e2e-tests","context":"E2E lipsă.","task":"Supertest `e2e/settings.spec.ts` la /settings.","dirs":["/core/apps/admin-core/api/tests/"],"constraints":"","output":"e2e verde"},
  {"step":235,"scope":"admin-swagger","context":"API doc.","task":"Integrează Swagger module `/docs` protejat basic-auth.","dirs":["/core/apps/admin-core/api/"],"constraints":"info.version from pkg.","output":"Swagger online"},
  {"step":236,"scope":"admin-ui-skel","context":"Frontend gol.","task":"Scaffold MUI pages Settings, RBAC, ThemeHub consumând API.","dirs":["/core/apps/admin-core/frontend/"],"constraints":"Use tanstack-query.","output":"UI pagini"},
  {"step":237,"scope":"admin-ui-settings","context":"Skeleton creat.","task":"Finalizează Settings form cu react-hook-form + zod.","dirs":["/core/apps/admin-core/frontend/"],"constraints":"tests 80%.","output":"page settings"},
  {"step":238,"scope":"admin-ui-rbac","context":"Directory page.","task":"Implementează tabel Users + Roles cu DataGrid Pro.","dirs":["/core/apps/admin-core/frontend/"],"constraints":"","output":"RBAC directory"},
  {"step":239,"scope":"admin-ui-theme","context":"ThemeHub.","task":"Upload JSON theme, preview live în iframe Shell.","dirs":["/core/apps/admin-core/frontend/"],"constraints":"size<25KB.","output":"ThemeHub UI"},
  {"step":240,"scope":"admin-ui-tests","context":"Unit tests page.","task":"Vitest + Jest-dom pentru cele 3 pagini.","dirs":["/core/apps/admin-core/frontend/"],"constraints":"","output":"tests pass"},
  {"step":241,"scope":"admin-ui-e2e","context":"Playwright.","task":"Add `admin-e2e` test create role, edit theme.","dirs":["/core/apps/admin-core/frontend-e2e/"],"constraints":"","output":"e2e verde"},
  {"step":242,"scope":"admin-ci","context":"CI generic.","task":"Nx affected pentru admin-core build/test + upload coverage Codecov.","dirs":["/.github/workflows/ci-template.yml"],"constraints":"Codecov token secret.","output":"CI admin"},
  {"step":243,"scope":"admin-dockerfile","context":"Containerizare.","task":"Dockerfile api (multi-stage Nest build) + Dockerfile ui.","dirs":["/docker/"],"constraints":"non-root 1000.","output":"images ok"},
  {"step":244,"scope":"admin-helm-chart","context":"Deploy admin.","task":"Chart `infra/helm/admin-core/` include api, ui, ingress, HPA.","dirs":["/infra/helm/admin-core/"],"constraints":"cosign sign.","output":"chart OCI"},
  {"step":245,"scope":"admin-otel","context":"Traces lipsă.","task":"Enable OTEL NestJS exporter + resource.service.name admin-api.","dirs":["/core/apps/admin-core/api/"],"constraints":"","output":"traces Tempo"},
  {"step":246,"scope":"admin-prom-metrics","context":"Metrics default.","task":"Add Prometheus metrics middleware Nest (`http_requests_seconds`).","dirs":["/core/apps/admin-core/api/"],"constraints":"","output":"metrics"},
  {"step":247,"scope":"admin-grafana","context":"Dashboard.","task":"Grafana dashboard RBAC ops (role count, fail auth).","dirs":["/infra/grafana/provisioning/dashboards/"],"constraints":"","output":"dashboard RBAC"},
  {"step":248,"scope":"admin-tenant-script","context":"Bootstrap tenant.","task":"Extinde `scripts/bootstrap-tenant.py` să cheme Admin API `/settings/init`.","dirs":["/scripts/"],"constraints":"","output":"script extins"},
  {"step":249,"scope":"admin-opa-policies","context":"Gatekeeper rule.","task":"Template Constraint `CTThemeValid` + Constraint `ThemeValid` limitează culoare hex.","dirs":["/infra/policies/opa/"],"constraints":"mode warn dev.","output":"OPA policy"},
  {"step":250,"scope":"admin-postman","context":"Colecție lipsă.","task":"Exportă Postman collection v2.1 în `docs/postman/admin-core.json`.","dirs":["/docs/postman/"],"constraints":"","output":"colecție postman"},
  {"step":251,"scope":"admin-hpa","context":"Scalare.","task":"Adaugă HPA CPU 50-300m pentru admin-api în chart.","dirs":["/infra/helm/admin-core/"],"constraints":"","output":"HPA activ"},
  {"step":252,"scope":"admin-jwt-secret","context":"JWT RS256.","task":"K8s Secret `admin-jwt` cu placeholder, montat la pod.","dirs":["/infra/k8s/"],"constraints":"no key leak.","output":"secret creat"},
  {"step":253,"scope":"admin-coverage-badge","context":"Codecov.","task":"Badge codecov în README root.","dirs":["/README.md"],"constraints":"","output":"badge vizibil"},
  {"step":254,"scope":"admin-argocd","context":"Continuous deploy.","task":"Argo Application YAML `admin-core.yaml`.","dirs":["/infra/k8s/argocd/"],"constraints":"","output":"Argo sync admin"},
  {"step":255,"scope":"admin-registry-client","context":"Worker Registry mutat în workers-core.","task":"Implementează client API pentru Worker Registry din workers-core: service `WorkerRegistryClient` care consumă `GET /v1/workers` și `GET /v1/workers/health` din workers-core API.","dirs":["/core/apps/admin-core/api/src/services/"],"constraints":"HTTP client cu retry și circuit breaker; cache Redis 30s","output":"client Worker Registry"},
  {"step":256,"scope":"admin-workers-ui","context":"Client API Worker Registry implementat.","task":"Creează UI în Admin Core pentru vizualizarea Worker Registry: pagină Workers cu tabel live status, health checks și butoane restart/scale (dacă permisiunile permit).","dirs":["/core/apps/admin-core/frontend/src/pages/"],"constraints":"polling 5s pentru refresh; MUI DataGrid","output":"UI Worker Registry în Admin"},
  {"step":257,"scope":"admin-workers-proxy","context":"UI Workers implementat.","task":"Adaugă endpoint proxy în Admin Core `/admin/workers/*` care forward către workers-core API cu autentificare și logging.","dirs":["/core/apps/admin-core/api/src/controllers/"],"constraints":"JWT scope admin:workers; rate limit 60 req/min","output":"proxy endpoints Workers"},
  {"step":258,"scope":"admin-workers-rbac","context":"Proxy endpoints implementate.","task":"Configurează RBAC pentru Worker Registry în Admin Core: roluri admin-workers (read-only) și admin-workers-ops (restart/scale).","dirs":["/core/apps/admin-core/api/src/guards/"],"constraints":"Keycloak groups mapping; unit tests","output":"RBAC Workers în Admin"},
  {"step":259,"scope":"admin-workers-tests","context":"RBAC Workers configurat.","task":"Adaugă teste pentru Worker Registry client și proxy: unit tests pentru client, e2e pentru proxy endpoints.","dirs":["/core/apps/admin-core/api/tests/"],"constraints":"Mock workers-core API; coverage ≥ 85%","output":"tests Worker Registry client"},
  {"step":260,"scope":"admin-nav-workers","context":"Worker Registry UI implementat.","task":"Adaugă intrare în navigația Admin Core pentru Workers: secțiune 'System' cu link la Worker Registry.","dirs":["/core/apps/admin-core/frontend/src/navigation/"],"constraints":"icon potrivit; conditional rendering pe role","output":"nav Workers în Admin"},
  {"step":261,"scope":"admin-workers-alerts","context":"Worker Registry integrat în Admin.","task":"Configurează alerte în Admin Core pentru Worker Registry: notificări UI când workers sunt down și integrare cu Alertmanager.","dirs":["/core/apps/admin-core/api/src/services/","/infra/k8s/alertmanager/"],"constraints":"WebSocket pentru real-time alerts în UI","output":"alerte Workers în Admin"},
  {"step":262,"scope":"admin-workers-config","context":"Configurare Worker Registry în Admin.","task":"Adaugă configurații pentru Worker Registry client în Admin Core: endpoints workers-core, timeouts, retry policies via ConfigMap/ExternalSecrets.","dirs":["/core/apps/admin-core/api/src/config/","/infra/k8s/"],"constraints":"environment-specific configs; no hardcoded URLs","output":"config Worker Registry client"},
  {"step":263,"scope":"admin-workers-docs","context":"Worker Registry integrat complet în Admin.","task":"Actualizează documentația Admin Core cu secțiunea Worker Registry: cum se folosește UI-ul, RBAC, și troubleshooting.","dirs":["/docs/api/admin-core.md"],"constraints":"include screenshots UI; troubleshooting common issues","output":"doc Worker Registry în Admin"},
  
  // 📊 OBSERVABILITATE ADMIN CORE (264-270)
  {"step":264,"scope":"admin-dashboard-tenant-management","context":"Tenant management dashboard lipsește.","task":"Creează dashboard Grafana pentru tenant management: tenant onboarding rates, resource usage per tenant, RBAC violations, tenant-specific performance metrics, billing analytics.","dirs":["/infra/grafana/provisioning/dashboards/"],"constraints":"UID admin_tenant_management; multi-tenant focus; security emphasis","output":"dashboard Admin Tenant Management"},
  {"step":265,"scope":"admin-dashboard-worker-registry-ops","context":"Worker Registry operational dashboard lipsește.","task":"Creează dashboard operațional pentru Worker Registry în Admin: worker health matrix, heartbeat status, queue depths, scaling events, failure recovery metrics.","dirs":["/infra/grafana/provisioning/dashboards/"],"constraints":"UID admin_worker_registry_ops; operational focus; real-time updates","output":"dashboard Admin Worker Registry Ops"},
  {"step":266,"scope":"admin-alerts-rbac-security","context":"RBAC security alerts lipsesc.","task":"Configurează alerte RBAC security pentru Admin: alert pentru failed login attempts > 10/min, alert pentru privilege escalation attempts, alert pentru suspicious admin activities.","dirs":["/infra/k8s/alertmanager/rules/"],"constraints":"security critical; immediate escalation; include user context","output":"alerte Admin RBAC Security"},
  {"step":267,"scope":"admin-alerts-tenant-isolation","context":"Tenant isolation breach alerts lipsesc.","task":"Configurează alerte tenant isolation: alert pentru cross-tenant data access, alert pentru TID session violations, alert pentru unauthorized tenant operations.","dirs":["/infra/k8s/alertmanager/rules/"],"constraints":"privacy critical; GDPR compliance; immediate response","output":"alerte Admin Tenant Isolation"},
  {"step":268,"scope":"admin-metrics-governance","context":"Governance metrics detaliate lipsesc.","task":"Adaugă metrici governance pentru Admin: policy compliance rates, audit trail completeness, configuration drift detection, security posture scores.","dirs":["/core/apps/admin-core/api/src/metrics/"],"constraints":"compliance tracking; audit requirements; governance standards","output":"metrici Admin Governance"},
  {"step":269,"scope":"admin-slo-platform","context":"Platform SLO tracking prin Admin lipsește.","task":"Definește Platform SLO în Admin: tenant onboarding < 5min (SLO 95%), RBAC response < 100ms (SLO 99%), configuration update propagation < 30s (SLO 90%).","dirs":["/infra/grafana/provisioning/dashboards/","/infra/k8s/alertmanager/rules/"],"constraints":"platform reliability SLOs; governance targets; operational excellence","output":"SLO Admin Platform definite"},
  {"step":270,"scope":"admin-dashboard-configuration-drift","context":"Configuration drift monitoring lipsește.","task":"Creează dashboard pentru configuration drift: infrastructure vs. desired state, policy compliance status, security configuration changes, unauthorized modifications.","dirs":["/infra/grafana/provisioning/dashboards/"],"constraints":"UID admin_config_drift; governance focus; change tracking","output":"dashboard Admin Configuration Drift"},
  
  // 🚀 DEPLOYMENT & SUPPLY CHAIN SECURITY ADMIN CORE (271-275)
  {"step":271,"scope":"admin-dockerfiles","context":"Containerizare pentru deployment necesară","task":"Creează Dockerfile pentru API Admin Core (NestJS multi-stage build) și Dockerfile pentru frontend (React Vite build + nginx non-root).","dirs":["/core/apps/admin-core/docker/"],"constraints":"user non-root 1000; optimizează dimensiunea imaginii; stage build separate","output":"Dockerfiles Admin Core create"},
  {"step":272,"scope":"admin-helm-chart","context":"Charts Helm pentru deployment","task":"Adaugă chart Helm pentru modul Admin Core: Deployment-uri Kubernetes pentru api și frontend, Service pentru API, IngressRoute Traefik cu host/path dedicat, și ServiceMonitor pentru metrici.","dirs":["/core/apps/admin-core/infra/helm/"],"constraints":"Include valori separate dev/prod; imagini semnate (cosign); testează upgrade chart local","output":"chart Helm Admin Core cu cosign"},
  {"step":273,"scope":"admin-ci-pipeline","context":"CI/CD pipeline pentru securitate","task":"Implementează CI/CD complet pentru Admin Core folosind template F0: Trivy scans cu praguri standardizate CRITICAL=0, HIGH≤3, MEDIUM≤15, SAST analysis pentru admin logic, RBAC security scanning, tenant isolation validation, SBOM generation, Cosign signing.","dirs":["/.github/workflows/"],"constraints":"admin security critical; RBAC protection; tenant isolation; fail on CRITICAL; codecov 85%; conform standard global","output":"CI/CD Admin Core securizat cu praguri standardizate"},
  {"step":274,"scope":"admin-argocd","context":"Chart Helm disponibil cu cosign","task":"Configurează Argo CD cu canary deployment pentru Admin Core: Argo Rollouts pentru admin APIs, traffic split 10%→50%→100%, analysis cu admin metrics (RBAC response time < 100ms, tenant operations success > 99.5%), automated rollback pe admin errors.","dirs":["/core/infra/k8s/argocd/","/core/apps/admin-core/infra/k8s/argo-rollouts/"],"constraints":"admin stability critical; tenant protection; RBAC reliability; automated rollback; cosign verify obligatoriu","output":"Admin Core canary deployment"},
  {"step":275,"scope":"admin-deployment-validation","context":"Deployment validation pentru Admin Core lipsește.","task":"Adaugă deployment validation pentru Admin Core: RBAC system verification, tenant isolation testing, configuration management validation, worker registry connectivity checks.","dirs":["/core/apps/admin-core/tests/deployment/","/core/apps/admin-core/scripts/validation/"],"constraints":"admin functionality critical; RBAC validation; tenant isolation testing; automated validation","output":"Admin Core deployment validation"}
]
```

**Nota:** acest roadmap individual este sincronizat automat cu `4_roadmap_f_1_core_platform.md`; nu modifica manual pașii din alt fișier.
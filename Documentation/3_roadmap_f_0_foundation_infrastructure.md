# 3 · Roadmap F0 – Foundation & Infrastructure (125 prompts CursorAI)

## Format JSON extins – câmpuri obligatorii:

- **`step`** – index consecutiv 1‑125 (consecutive integers only)
- **`scope`** – sub‑sistem vizat
- **`context`** – livrări anterioare relevante
- **`task`** – instrucțiune imperativă clară
- **`dirs`** – directoare vizate
- **`constraints`** – reguli stricte
- **`output`** – rezultat așteptat

## Reguli generale

Respectă structura din `0_Instructiuni_…`; nu inventa module; nu hard‑code secrete; nu executa task‑uri în afara scopului curent.

## Lista task-urilor F0

```json
[
  {"step":1,"scope":"scripts-bootstrap","context":"Repo gol; lipsesc scripturi.","task":"Generează scripts/init.sh skeleton (funcţii declarate, TODO) cu shebang bash şi set -euo pipefail.","dirs":["/scripts/"],"constraints":"chmod +x; commit 'feat(script): scaffold init.sh'.","output":"scripts/init.sh skeleton"},
  {"step":2,"scope":"scripts-populate","context":"init.sh skeleton creat în pasul 1.","task":"Implementează logică reală în fiecare funcţie din init.sh: pnpm dlx create-nx-workspace, pnpm install, poetry install, pre‑commit install. Adaugă flag --dry-run.","dirs":["/scripts/init.sh"],"constraints":"Nu executa workspace create în acest commit; commit 'feat(script): populate init.sh'.","output":"init.sh fully functional"},
  {"step":3,"scope":"git-remote-create","context":"Nu există repo remote.","task":"Creează repo privat 'genius-suite' în org GitHub 'company-org' cu default branch main şi licenţă MIT.","dirs":["(GitHub remote)"],"constraints":"Repo gol.","output":"URL repo"},
  {"step":4,"scope":"workspace-bootstrap","context":"init.sh implementat (pas 2).","task":"Clonează repo, copiază scripts/, rulează init.sh --dry-run pentru test apoi init real; creează workspace Nx 18, pnpm, poetry, pre‑commit hooks.","dirs":["/<repo-root>/"],"constraints":"Commit 'chore(init): bootstrap workspace'.","output":"Structură bază"},
  {"step":5,"scope":"git-governance","context":"Branch main creat.","task":"Activează branch protection (PR, status checks, linear history).","dirs":["(GitHub settings)"],"constraints":"No develop branch.","output":"Branch protejat"},
  {"step":6,"scope":"workspace-node","context":"pnpm workspaces lipsă.","task":"Adaugă pnpm-workspace.yaml cu globs core/** şi standalone/**.","dirs":["/<repo-root>/"],"constraints":"Indentare 2 spaţii.","output":"pnpm‑workspace.yaml"},
  {"step":7,"scope":"workspace-python","context":"Python tooling absent.","task":"Iniţializează Poetry cu black,mypy,pytest (dev).","dirs":["/<repo-root>/"],"constraints":"Commit 'build(poetry): init'.","output":"pyproject.toml"},
  {"step":8,"scope":"quality-hooks","context":"pre‑commit neconfigurat.","task":"Adaugă .pre-commit-config.yaml (black,isort,ruff,eslint,prettier,shellcheck) şi rulează pre‑commit install.","dirs":["/<repo-root>/"],"constraints":"Commit 'chore(lint): pre‑commit'.","output":"Hooks active"},
  {"step":9,"scope":"nx-config","context":"Workspace Nx minim.","task":"Configurează enforceModuleBoundaries cu tags scope & layer.","dirs":["/workspace.json"],"constraints":"No projects.","output":"Rule boundaries"},
  {"step":10,"scope":"docs","context":"Grafic dependenţe absent.","task":"Rulează pnpm nx graph şi salvează docs/graph.svg (<1MB).","dirs":["/docs/"],"constraints":"Commit 'docs(graph): initial'.","output":"graph.svg"},
  {"step":11,"scope":"scripts","context":"manage-app.sh lipseşte.","task":"Creează scripts/manage-app.sh skeleton cu func help.","dirs":["/scripts/"] ,"constraints":"chmod +x","output":"manage-app.sh"},
  {"step":12,"scope":"s3-backend-bucket","context":"Terraform backend necesită bucket remote.","task":"Creează bucket S3 'tf-backend-genius' şi folder state/dev|stage|prod prin AWS CLI sau Terraform separate-stack.","dirs":["(AWS)"],"constraints":"Versioning ON, encryption SSE-S3.","output":"Bucket creat"},
  {"step":13,"scope":"s3-backend-policy","context":"Bucket `tf-backend-genius` a fost creat în pasul 12 fără policy de securitate pentru enforcement encryption.","task":"Atașează bucket policy care refuză orice `PutObject` fără header `x-amz-server-side-encryption=AES256` și `aws:PrincipalType != \"AWSService\"` pentru a bloca accesul accidental din servicii non-AWS.","dirs":["(AWS console / CLI)"],"constraints":"Versioning și SSE-S3 deja activate; policy JSON salvat în infra/terraform/base/s3-backend-policy.json pentru audit.","output":"Bucket protejat; fișier policy json commitat"},
  {"step":14,"scope":"terraform-base","context":"infra/terraform absent.","task":"Creează infra/terraform/base cu backend.tf referind bucket creat la pas 12 şi providers.tf.","dirs":["/core/infra/terraform/base/"],"constraints":"placeholders region.","output":"backend.tf"},
  {"step":15,"scope":"terraform-dns-module","context":"Back‑end TF iniţializat/definit (step 14)","task":"Creează modul `route53-dev` cu zone publică + records var‑driven","dirs":["/core/infra/terraform/modules/dns/route53-dev/"],"constraints":"SSE‑S3, versioning ON","output":"modul Route53 gata"},
  {"step":16,"scope":"terraform-init","context":"Backend definit.","task":"Rulează terraform init (remote backend).","dirs":["/core/infra/terraform/base/"],"constraints":"No apply.","output":"Init successful"},
  {"step":17,"scope":"terraform-modules","context":"Modules missing.","task":"Skeleton vpc & k8s-cluster modules (main, vars, outputs).","dirs":["/core/infra/terraform/modules/vpc/","/core/infra/terraform/modules/k8s-cluster/"] ,"constraints":"TODO marks.","output":"Modules skeleton"},
  {"step":18,"scope":"ci-template","context":"CI workflows absent.","task":"Creează .github/workflows/ci-template.yml (build,test,scan,terraform‑plan).","dirs":["/.github/workflows/"],"constraints":"Ubuntu 22.04.","output":"ci-template"},
  {"step":19,"scope":"ci-security","context":"Workflow‑ul CI general a fost creat la step 18; scan‑ul Trivy rulează cu prag implicit MEDIUM.","task":"Adaugă Trivy scan cu praguri standard: CRITICAL = 0, HIGH ≤ 3, MEDIUM ≤ 15.","dirs":["/.github/workflows/ci-template.yml"],"constraints":"Rulează `trivy image`/`trivy fs` cu `--severity CRITICAL,HIGH,MEDIUM --exit-code 1`; fail pe CRITICAL > 0 sau HIGH > 3; commit-msg Convention‑al Commits: `ci(scan): enforce Trivy standard thresholds`.", "output":"Trivy step cu praguri standard"},
  {"step":20,"scope":"ci-supplychain","context":"Cosign missing.","task":"Adaugă cosign sign step post‑build key k8s://cosign.","dirs":["/.github/workflows/ci-template.yml"],"constraints":"sigstore action.","output":"Cosign step"},
  {"step":21,"scope":"ops-compose","context":"ops/dev gol; necesare servicii de bază pentru dezvoltare locală.","task":"docker-compose.yml cu traefik, PostgreSQL 17, rabbitmq, redis, minio.","dirs":["/ops/dev/"],"constraints":"Schema compose 3.9; versiuni specifice servicii conform readme 2; no latest tags; PostgreSQL 17 mandatory; blochează tag-urile imaginilor prin SHA pentru reproducibilitate locală.","output":"compose"},
  {"step":22,"scope":"ops-services","context":"Completează servicii compose (pas 21) cu healthchecks & env din .env.","task":"Configurează traefik, PostgreSQL 17, rabbitmq, redis, minio detaliat.","dirs":["/ops/dev/"] ,"constraints":"No passwords hard-coded; PostgreSQL 17 cu pgvector extension pentru dev consistency.","output":"services healthy"},
  {"step":23,"scope":"env-config","context":"Nu există .env file.","task":"Creează .env.example placeholders, copiază în .env local dev, adaugă .env în .gitignore.","dirs":["/"],"constraints":"Commit doar example.","output":".env.example"},
  {"step":24,"scope":"ci-env-sanitise","context":"Serviciile din `docker-compose` folosesc `.env` local creat în pasul 23; CI poate expune accidental aceste variabile sensibile.","task":"Adaugă la joburile CI o regulă `paths-ignore` pentru `.env`, artefact filter care exclude fișiere *.env.* și rule log-output mask `::add-mask::${{ secrets.* }}` pentru extra hardening.","dirs":["/.github/workflows/ci-template.yml"],"constraints":"Nu publica variabile de mediu secrete în log-uri; păstrează `.env.example` versionat.","output":"CI nu mai poate expune `.env` în artefacte"},
  {"step":25,"scope":"terraform-vpc-vars","context":"Modul VPC skeleton creat în step 17.","task":"Define variables cidr, az_count.","dirs":["/core/infra/terraform/modules/vpc/"],"constraints":"naming ‑ no uppercase; follow Terraform tfsec.","output":"variables.tf"},
  {"step":26,"scope":"terraform-vpc-main","context":"Variables VPC definite în step 25.","task":"Implement aws_vpc + subnets.","dirs":["/core/infra/terraform/modules/vpc/"],"constraints":"No CIDR hard-coded; naming ‑ no uppercase; follow Terraform tfsec.","output":"main.tf"},
  {"step":27,"scope":"terraform-vpc-outputs","context":"VPC și subnets implementate în step 26.","task":"Add outputs vpc_id, public_subnets, private_subnets.","dirs":["/core/infra/terraform/modules/vpc/"],"constraints":"naming ‑ no uppercase; follow Terraform tfsec.","output":"outputs.tf"},
  {"step":28,"scope":"terraform-k8s-vars","context":"Modulul `k8s-cluster` skeleton a fost generat la step 17, iar backend-ul Terraform a fost inițializat la step 16; variabilele cluster lipsesc.","task":"Define cluster_name, node_count, node_type vars; generează terraform-docs schema pentru consistență automată.","dirs":["/core/infra/terraform/modules/k8s-cluster/"],"constraints":"Nume variabile lower_snake_case, fără valori hard-codate; respectă tfsec; commit `feat(tf): k8s vars`.","output":"variables.tf + docs schema"},
  {"step":29,"scope":"terraform-k8s-main","context":"Variabilele cluster (step 28) sunt declarate, dar resursele EKS nu există.", "task":"aws_eks_cluster + node_group.","dirs":["/core/infra/terraform/modules/k8s-cluster/"] ,"constraints":"Fără `terraform apply`; naming no‑uppercase; tfsec clean; commit `feat(tf): k8s main`.","output":"main.tf"},
  {"step":30,"scope":"terraform-k8s-outputs","context":"Resursele EKS declarate la step 29 necesită outputs pentru a fi consumate downstream (kubeconfig, endpoint).", "task":"outputs cluster_endpoint, kubeconfig.","dirs":["/core/infra/terraform/modules/k8s-cluster/"] ,"constraints":"Same naming/tfsec reguli; commit `feat(tf): k8s outputs`.", "output":"outputs.tf"},
  {"step":31,"scope":"terraform-envs","context":"Need tfvars.","task":"Create envs/dev,stage,prod tfvars referencing modules.","dirs":["/core/infra/terraform/envs/"] ,"constraints":"placeholders.","output":"tfvars"},
  {"step":32,"scope":"ci-terraform-plan","context":"Terraform plan job exists but without bucket perms.","task":"Configure AWS creds via OIDC in CI for plan job.","dirs":["/.github/workflows/ci-template.yml"],"constraints":"least privilege.","output":"Plan job green"},
  {"step":33,"scope":"k8s-namespaces","context":"Clusterul dev este inițializat (step 29-32), însă namespace-urile de bază pentru organizarea resurselor nu sunt create.","task":"Creează namespaces tools,gateway,observability cu label-urile standard app.kubernetes.io/instance.","dirs":["/core/infra/k8s/"],"constraints":"Fișier YAML `infra/k8s/namespaces-dev.yaml`; commit `feat(k8s): namespaces`.","output":"namespaces yaml"},
  {"step":34,"scope":"helmfile","context":"Cluster dev gata; trebuie instalate TOATE release‑urile de bază.","task":"Umbrella helmfile instalează în ORDINE: istio‑base (profile=minimal), traefik, cert‑manager, keycloak, kube‑prom‑stack, loki, tempo, rabbitmq, redis, postgresql, keda‑operator. **Networking Strategy:** Istio (east-west service mesh + mTLS) + Traefik (north-south ingress + WAF) cu responsabilități claire și complementare. **Keycloak Transition:** Înlocuiește Keycloak PoC din step 0-3 cu production deployment – migrates realm configuration from lightweight setup to full HA cluster. Configurează dependencies, resource limits, persistent volumes, service monitors și health checks pentru fiecare chart.","dirs":["/core/infra/helmfile/"],"constraints":"OCI charts; istio‑base > v1.24; rabbitmq v3.14; keda v2.14; PostgreSQL 17 cu high availability; toate chart-urile cu resource limits; PV RWO pentru stateful services; migrate realm config from PoC","output":"helmfile apply → toate release‑urile rulând cu monitoring"},
  {"step":35,"scope":"postgresql-pgvector-extension","context":"PostgreSQL 17 instalat (step 34); AI/ML capabilities necesită pgvector extension pentru embeddings și similarity search.","task":"Configurează pgvector extension în PostgreSQL 17 cluster: enable extension în database template, configurează shared_preload_libraries, testează vector operations și similarity search cu HNSW index.","dirs":["/core/infra/helmfile/values-postgresql.yaml","/core/infra/k8s/postgresql/"],"constraints":"pgvector >= 0.5.0 (PostgreSQL-17-compatible); test cu SELECT '(1,2,3)'::vector <-> '(1,2,4)'::vector; commit 'feat(pg): pgvector extension enable pentru PostgreSQL 17'","output":"PostgreSQL 17 cu pgvector ready pentru AI/ML"},
  {"step":36,"scope":"cert-manager-values","context":"Traefik şi cert‑manager au chart‑uri Helm, dar valorile personalizate lipsesc.", "task":"values-traefik.yaml dashboard, rateLimit; values-cert-manager.yaml empty.","dirs":["/core/infra/helmfile/"] ,"constraints":"Fişierele trebuie puse sub control versionare cu prefix `values‑<chart>.yaml`; commit `feat(helm): values traefik & cert‑manager`.", "output":"values files"},
  {"step":37,"scope":"cert-issuers","context":"Cert‑manager rulează (step 34) dar nu există emisii CA.", "task":"ClusterIssuer selfsigned + LetsEncrypt staging.","dirs":["/core/infra/k8s/"] ,"constraints":"Issuer‑ele trebuie semnate self‑signed şi Let's Encrypt (staging); commit `feat(k8s): issuers`.", "output":"issuers yaml"},
  {"step":38,"scope":"mTLS-internal","context":"Istio-base + cert-manager rulează (step 34); issuers creați (step 36); traficul intern trebuie securizat dar fără întrerupere servicii.","task":"Creează PeerAuthentication PERMISSIVE și Issuer `mesh-ca` self-signed pentru inițializare. Strategia graduală mTLS va fi implementată în steps 102-104 pentru zero downtime migration.","dirs":["/core/infra/k8s/","/core/infra/helmfile/"],"constraints":"Traffic production friendly – nu blochează handshake; test cu istioctl authn tls-check","output":"mTLS permissive activat, trafic funcțional"},
  {"step":39,"scope":"istio-namespace-label","context":"mTLS permissive a fost activat (step 37); pentru funcționarea mesh-ului, namespace-ul `gateway` trebuie etichetat pentru injectarea automată Envoy side-car.","task":"Aplică `kubectl label namespace gateway istio-injection=enabled --overwrite` și adaugă manifest permanent în infra/k8s/namespaces-dev.yaml. Integrează task-ul în pre-merge GitHub Action.","dirs":["/core/infra/k8s/"],"constraints":"Folosește `kubectl label` în script Makefile; commit `chore(istio): label gateway`.","output":"Pods din namespace gateway primesc side-car Envoy"},
  {"step":40,"scope":"istio-label-namespaces","context":"Aceeaşi logică de injectare Envoy se extinde la `workers-core` şi `admin-core`.","task":"Label namespaces `workers-core` şi `admin-core` cu `istio-injection=enabled`.","dirs":["/core/infra/k8s/"],"constraints":"Manifest persistent în `infra/k8s/namespaces-dev.yaml`; commit `chore(istio): label workers/admin`.","output":"side‑car Envoy în toate namespace‑urile"},
  {"step":41,"scope":"gateway-health-ingress","context":"Gateway rulează dar nu are rută health expusă prin Traefik.", "task":"IngressRoute shell-health mapping /health.","dirs":["/core/infra/k8s/"] ,"constraints":"CRD `IngressRoute` (`kind: IngressRoute`); path `/health`; commit `feat(gateway): health ingress`.", "output":"IngressRoute"},
  {"step":42,"scope":"irsa-eso-combined","context":"Istio + Traefik + OIDC ready; IRSA inexistent pentru ESO.", "task":"1) Terraform module `iam-irsa-eso`; 2) Helm External‑Secrets Operator; 3) SecretStore dev.", "dirs":["/infra/terraform/modules/iam-irsa-eso/","/infra/helmfile/","/infra/k8s/"], "constraints":"IRSA role first → ESO helm second → SecretStore; commit 'feat(infra): eso + irsa combined'.", "output":"ESO funcțional cu IRSA (fără credențiale statice)"},
  {"step":43,"scope":"observability-values","context":"Stack‑ul observabilitate este instalat (step 34) dar nu are valori custom pentru datasource‑uri şi user Grafana.", "task":"values-prom.yaml grafana admin secret ref; tempo values.","dirs":["/core/infra/helmfile/"] ,"constraints":"Fişiere `values-prom.yaml`, `values-tempo.yaml`; secret ref către ExternalSecrets (ESO); commit `feat(obs): values prom+tempo`.", "output":"values"},
  {"step":44,"scope":"opa-gatekeeper","context":"Admission control lipsă.","task":"Deploy OPA Gatekeeper helm chart no policies.","dirs":["/core/infra/helmfile/"] ,"constraints":"values-gatekeeper.yaml." ,"output":"Gatekeeper pods"},
  {"step":45,"scope":"argo-cd","context":"CD absent.","task":"Deploy Argo CD helm release in namespace tools + app-of-apps linking helmfile repo.","dirs":["/core/infra/helmfile/"] ,"constraints":"values-argo.yaml." ,"output":"Argo CD ready"},
  {"step":46,"scope":"argo-sync-dev","context":"Argo CD a fost instalat la step 44; aplicaţia dev nu este sincronizată.", "task":"Create Argo Application dev referencing helmfile; run argocd app sync dev.","dirs":["(argo cli)"],"constraints":"Foloseşte `argocd app sync dev` din GH Action manual; commit `chore(argo): sync dev`.","output":"dev synced"},
  {"step":47,"scope":"dns-dev-record","context":"LoadBalancer Traefik expus (helm rollout complete); modulul DNS deja creat la step 15; necesită record A pentru gateway.","task":"Adaugă record ALIAS `dev.genius-suite.example.com` → DNS LB Traefik **printr-un sub-modul** `infra/terraform/modules/dns` (nu manual); rulează `terraform apply`. Include external-dns annotation pentru update-uri dinamice.","dirs":["/infra/terraform/modules/dns/"],"constraints":"Terraform only; TTL = 60 sec; no hardcoded IPs; module reusable.","output":"dns record activ via IaC"},
  {"step":48,"scope":"grafana-dashboards","context":"Grafana rulează dar nu are dashboard‑uri pentru HTTP & Celery.", "task":"Provision dashboards HTTP_requests & worker lag.","dirs":["/infra/grafana/provisioning/dashboards/"] ,"constraints":"Dashboard JSON linted cu `jsonlint`; UID previzibil; commit `feat(grafana): http & worker dashboards`.","output":"dashboards"},
  {"step":49,"scope":"grafana-datasources","context":"Data‑sources Grafana lipsesc; Prometheus şi Loki trebuie declarate.", "task":"Prometheus & Loki datasources provisioning.","dirs":["/infra/grafana/provisioning/datasources/"] ,"constraints":"Fişiere de provisioning în `infra/grafana/provisioning/datasources/`; commit `feat(grafana): datasources prom+loki`.", "output":"datasources"},
  {"step":50,"scope":"jsonlint-ci","context":"Dashboard‑urile adăugate la step 47 necesită validare statică în CI.", "task":"Add jsonlint for dashboards in CI.","dirs":["/.github/workflows/ci-template.yml"],"constraints":"Adaugă job `jsonlint` în `.github/workflows/ci-template.yml`; commit `ci(lint): json dashboards`.", "output":"lint step"}
  {"step":51,"scope":"manage-app-start","context":"`scripts/manage-app.sh` skeleton creat la step 11; funcţia `start()` este goală.", "task":"Implement start() docker compose up.","dirs":["/scripts/manage-app.sh"],"constraints":"Respectă `set -euo pipefail`; doar wrapper la `docker compose up -d`; commit `feat(script): manage-app start`.", "output":"start works"}
  {"step":52,"scope":"manage-app-stop","context":"Complement pentru step 50 – oprire servicii.", "task":"Implement stop() compose down.","dirs":["/scripts/manage-app.sh"],"constraints":"`docker compose down --remove-orphans`; commit `feat(script): manage-app stop`.", "output":"stop works"}
  {"step":53,"scope":"manage-app-logs","context":"Necesită acces simplu la log‑uri Dev.", "task":"logs() tail.","dirs":["/scripts/manage-app.sh"],"constraints":"Implementare `docker compose logs -f`; commit `feat(script): manage-app logs`.", "output":"logs"}
  {"step":54,"scope":"manage-app-switch-env","context":"Developerii trebuie să comute rapid între fişiere .env.", "task":"switch-env() .env.$TARGET.","dirs":["/scripts/manage-app.sh"],"constraints":"Funcţia `switch-env()` validează existenţa `.env.$TARGET`; commit `feat(script): manage-app switch-env`.", "output":"switch works"}
  {"step":55,"scope":"docs-f0","context":"După finalizarea primelor 54 paşi, documentaţia F0 nu rezumă activitatea.", "task":"Create docs/F0_foundation.md recap steps 1-54.","dirs":["/docs/"] ,"constraints":"Generarea Markdown; referinţă la fiecare step; commit `docs(f0): recap 1-54`.", "output":"doc"}
  {"step":56,"scope":"pytest-ci","context":"Poetry este configurat (step 7) însă testele Python nu rulează în CI.", "task":"Add poetry run pytest in CI.","dirs":["/.github/workflows/ci-template.yml"],"constraints":"Adaugă job `poetry run pytest`; fail dacă coverage<80%; commit `ci(pytest): enable`.", "output":"pytest"},
  {"step":57,"scope":"vitest-ci","context":"Tests FE (Vitest) nu au încă job separat.", "task":"nx affected -t test.","dirs":["/.github/workflows/ci-template.yml"],"constraints":"Rulează `pnpm nx affected -t test`; commit `ci(vitest): enable`.", "output":"vitest"},
  {"step":58,"scope":"coverage","context":"Coverage colectat la 55/56, dar nu se publică.", "task":"Upload to codecov.","dirs":["/.github/workflows/ci-template.yml"],"constraints":"Upload Codecov; token secret în GH; commit `ci(coverage): codecov upload`.", "output":"coverage"},
  {"step":59,"scope":"codeql","context":"SAST CodeQL nu e activ.", "task":"Enable CodeQL.","dirs":["/.github/workflows/codeql.yml"],"constraints":"Workflow `.github/workflows/codeql.yml`; limbaje: `javascript, python, terraform`; commit `ci(sast): codeql`.", "output":"CodeQL"},
  {"step":60,"scope":"dependabot","context":"Dependenţele nu sunt monitorizate.", "task":"dependabot config.","dirs":["/.github/"] ,"constraints":"`.github/dependabot.yml` ţinteşte `npm`,`pip`,`docker`,`terraform`; commit `chore: dependabot`.", "output":"dependabot"},
  {"step":60,"scope":"dockerignore","context":"Imagini Docker vor ignora fişiere inutile.", "task":".dockerignore root.","dirs":["/"] ,"constraints":".dockerignore minimale (node_modules, dist, .venv, *.env*); commit `build(docker): add ignore`.","output":".dockerignore"},
  {"step":61,"scope":"docker-base-images","context":"Imagini builder de bază absent.", "task":"Dockerfile.node-base & python-base.","dirs":["/docker/"] ,"constraints":"Dockerfile.node‑base (FROM node:20-slim, non‑root 1000) & python-base (FROM python:3.13-slim); commit `build(docker): base images`.", "output":"base images"},
  {"step":62,"scope":"makefile","context":"Convenţii make lipsesc (dev‑DX).", "task":"Makefile dev helpers.","dirs":["/"] ,"constraints":"Target‑uri `setup`, `start`, `stop`, `lint`; commit `build(make): helpers`.", "output":"Makefile"},
  {"step":63,"scope":"create-module-cli","context":"CLI pentru module nu a fost scaffold‑at.", "task":"scripts/create-module.ts skeleton.","dirs":["/scripts/"] ,"constraints":"Script TS + shebang; chmod +x; commit `feat(cli): create-module`.", "output":"create-module ts"},
  {"step":64,"scope":"create-worker-cli","context":"CLI pentru workeri nu există.", "task":"scripts/create-worker.py skeleton.","dirs":["/scripts/"] ,"constraints":"Python typer CLI; chmod +x; commit `feat(cli): create-worker`.", "output":"create-worker"},
  {"step":65,"scope":"compose-stage","context":"Compoziţia Docker pentru stage nu a fost definită.", "task":"ops/stage compose.","dirs":["/ops/stage/"] ,"constraints":"File `ops/stage/docker-compose.yml`; schema 3.9; commit `ops(stage): compose`.", "output":"compose stage"},
  {"step":66,"scope":"compose-prod","context":"Analog pentru prod.", "task":"ops/prod compose.","dirs":["/ops/prod/"] ,"constraints":"`ops/prod/docker-compose.yml`; commit `ops(prod): compose`.", "output":"compose prod"},
  {"step":67,"scope":"kustomize-overlays","context":"Suprapuneri Kustomize lipsă.", "task":"overlays dev/stage/prod.","dirs":["/infra/kustomize/"] ,"constraints":"Directory `infra/kustomize/overlays/{dev,stage,prod}`; commit `feat(k8s): overlays`.", "output":"overlays"},
  {"step":68,"scope":"helm-umbrella","context":"Chart umbrella central.", "task":"umbrella chart + values dev/prod.","dirs":["/infra/helm/umbrella/"] ,"constraints":"OCI push; semnat Cosign; commit `feat(helm): umbrella chart`.", "output":"chart"},
  {"step":69,"scope":"traefik-dashboard","context":"Dashboard Traefik protejat basic‑auth.", "task":"IngressRoute dashboard basic‑auth dev.","dirs":["/core/infra/k8s/"] ,"constraints":"Secret basic‑auth în namespace gateway; commit `feat(gateway): traefik dashboard ingress`.", "output":"IngressRoute"},
  {"step":70,"scope":"keycloak-realm","context":"Export realm Keycloak template din production setup (step 34).","task":"realm-export JSON pentru template reuse și backup configuration.","dirs":["/infra/keycloak/"] ,"constraints":"JSON export cu `keycloak export`; commit `feat(auth): realm template`.", "output":"realm"},
  {"step":71,"scope":"theme-config","context":"Teme UI necesită ConfigMap.", "task":"theme ConfigMap.","dirs":["/core/infra/k8s/"] ,"constraints":"ConfigMap `shell-theme-default` + checksum label; commit `feat(theme): configmap`.", "output":"configmap"},
  {"step":72,"scope":"secret-postgres","context":"Secret conexiune Postgres dev.", "task":"secret pg dev.","dirs":["/core/infra/k8s/"] ,"constraints":"K8s Secret generat de ESO; patch `external-secret`; commit `feat(pg): dev secret`.", "output":"secret"},
  {"step":73,"scope":"pgbouncer","context":"Pgbouncer layer trebui configurat înainte de app‑uri.", "task":"pgbouncer ConfigMap.","dirs":["/core/infra/k8s/"] ,"constraints":"ConfigMap ini file; HBA strict; commit `feat(pg): pgbouncer cfg`.", "output":"pgbouncer"},
  {"step":74,"scope":"minio-buckets","context":"Bucket‑urile MinIO necesare.", "task":"Job bucket init.","dirs":["/core/infra/k8s/"] ,"constraints":"Job init în namespace tools; commit `feat(minio): bucket init job`.", "output":"job"}
  {"step":75,"scope":"rabbitmq-cluster","context":"RabbitMQ cluster instalat în step 34; aici doar ConfigMap defs","task":"Creează **ConfigMap `rmq-defs`** cu declararea queues/exchanges core (`core.v1`); aplică `helm upgrade` pentru a monta definiția în statefulset.","dirs":["/infra/k8s/","/infra/helmfile/"],"constraints":"Este **unica** definiție RMQ – modulele F1 nu redeclară.","output":"RMQ cluster live cu defs"},
  {"step":76,"scope":"redis-config","context":"Redis valori default lipsă.", "task":"redis configmap.","dirs":["/core/infra/k8s/"] ,"constraints":"ConfigMap `redis.conf`; commit `feat(redis): configmap`.", "output":"redis config"}
  {"step":77,"scope":"backup-script","context":"Back‑up S3 script inexistent.", "task":"scripts/backup-s3.sh.","dirs":["/scripts/"] ,"constraints":"Bash + flock + s3 cp; commit `feat(script): backup-s3`.", "output":"backup script"}
  {"step":78,"scope":"shellcheck-hook","context":"Shellcheck absent în pre‑commit.", "task":"shellcheck hook pre‑commit.","dirs":["/"],"constraints":"Hook entry `shellcheck -x`; commit `chore(lint): shellcheck hook`.", "output":"hook"}
  {"step":79,"scope":"ci-shellcheck","context":"CI nu rulează ShellCheck.", "task":"shellcheck job CI.","dirs":["/.github/workflows/ci-template.yml"],"constraints":"Job matrix scripts/*.sh; commit `ci(shell): shellcheck`.", "output":"shellcheck job"}
  {"step":80,"scope":"editorconfig","context":"EditorConfig lipsă.", "task":".editorconfig root.","dirs":["/"] ,"constraints":"Indent 2 spaces YAML, 4 spaces Python; commit `style: editorconfig`.", "output":"editorconfig"}
  {"step":81,"scope":"eslint-config","context":"Reguli ESLint custom nu există.", "task":"packages/rules-eslint.","dirs":["/packages/rules-eslint/"] ,"constraints":"Package `packages/rules-eslint` + index.js shareable config; commit `feat(lint): eslint rules`.", "output":"eslint package"}
  {"step":82,"scope":"tsconfig-base","context":"Monorepo TS nu are tsconfig‑base.", "task":"tsconfig.base.json.","dirs":["/"] ,"constraints":"`compilerOptions.strict = true`; pathAliases conform Nx; commit `build(ts): base tsconfig`.", "output":"tsconfig.base"}
  {"step":83,"scope":"mypy-black","context":"Black & mypy neconfigurate global.", "task":"mypy.ini & black config.","dirs":["/"],"constraints":"Add `pyproject.toml` black 23.*, `mypy.ini` strict; commit `build(py): black+mypy cfg`.", "output":"configs"}
  {"step":84,"scope":"docs-readme","context":"README rădăcină lipseşte.", "task":"Root README.md.","dirs":["/"] ,"constraints":"Titlu proiect, badge build, link docs; commit `docs: root readme`.", "output":"README"}
  {"step":85,"scope":"gitignore-env","context":".env fişier sensibil; gitignore incomplet.", "task":"Add .env to .gitignore.","dirs":["/"] ,"constraints":"Adaugă `.env` şi `.env.*`; commit `chore(git): ignore env`.", "output":"gitignore"}
  {"step":86,"scope":"lint-run","context":"Reguli pre‑commit adăugate (step 8) dar nu au rulat all‑files.", "task":"pre‑commit run --all-files.","dirs":["/"] ,"constraints":"Rulează `pre-commit run --all-files`; commit `chore(lint): initial clean`.", "output":"clean"}
  {"step":87,"scope":"push-origin","context":"Modificările nu au fost împinse la remote.", "task":"git push origin main.","dirs":["(git)"],"constraints":"`git push --follow-tags origin main`; commit message N/A (operaţiune CI/CD).", "output":"pushed"}
  {"step":88,"scope":"pull-request","context":"PR default trebuie fuzionat.", "task":"PR merge." ,"dirs":["(GitHub)"],"constraints":"Protect‑branch require reviews; merge via squash; no fast‑forward.", "output":"PR merged"}
  {"step":89,"scope":"smoke-test-k6","context":"Gateway /health expus.","task":"Rulează k6 script 100 VUs 30s pe /health şi output JSON summary.","dirs":["/tests/k6/"] ,"constraints":"fail threshold error_rate<1%.","output":"k6 report"},
  {"step":90,"scope":"ci-k6","context":"k6 script creat la step 89; lipsă job CI.", "task":"Adaugă job k6 smoke în CI build pipeline şi publică grafana cloud scenario.","dirs":["/.github/workflows/ci-template.yml"],"constraints":"Job după build; artefact HTML & JSON; commit `ci(perf): k6 smoke`." ,"output":"CI k6 job"}
  {"step":91,"scope":"prometheus-traefik-monitor","context":"ServiceMonitor Traefik trebuie să expună metri­ci.", "task":"ServiceMonitor traefik.","dirs":["/core/infra/k8s/"] ,"constraints":"CRD kind `ServiceMonitor`; selector `app: traefik`; commit `feat(obs): traefik monitor`.", "output":"ServiceMonitor"}
  {"step":92,"scope":"loki-driver","context":"Driver Loki SDS nu trimite log‑uri istio‑proxy.", "task":"Patch daemonset SDS.","dirs":["/core/infra/k8s/"] ,"constraints":"Patch DaemonSet `loki-promtail` cu container securityContext readOnlyRootFs=true; commit `fix(logs): loki sds`.", "output":"Logs"}
  {"step":93,"scope":"otel-collector","context":"Collector OTEL lipsă.", "task":"Helm OTEL collector.","dirs":["/core/infra/helmfile/"] ,"constraints":"Helm chart `opentelemetry-collector`; mode deployment; commit `feat(obs): otel collector`.", "output":"collector"}
  {"step":94,"scope":"nx-affected-test","context":"Testele Nx afectate trebuie să ruleze înainte de gate‑uri.", "task":"Ensure tests pass.","dirs":["/"] ,"constraints":"`nx affected -t test,lint`; commit `ci(nx): affected test`.", "output":"tests"}
  {"step":95,"scope":"gate-f0","context":"CI verde, Argo dev synced; toate componentele F0 implementate (step 1-94); necesară validare finală înainte de trecerea la F1.","task":"Rulează script `scripts/gate-f0.sh` ce verifică: • job GitHub `ci-template.yml` status==success; • `curl https://dev.genius-suite.example.com/health`==200; • `curl $RMQ/api/aliveness-test/%2F` status==ok; • dashboard UID `infra_overview` este OK >= 90 %; • validare status Grafana via API `/api/health`.","dirs":["/scripts/"],"constraints":"script exit!=0 → gate fail, nu merge mai departe.","output":"Gate F0 satisfied"},
  {"step":96,"scope":"tag-release","context":"Tag semantic version pentru livrabile F0.", "task":"Tag v0.1.0-f0 şi release notes.","dirs":["(git/GitHub)"],"constraints":"Git tag `v0.1.0-f0` + GH Release; commit `chore(release): f0 0.1.0`.", "output":"release"}
  {"step":97,"scope":"notify","context":"Stakeholder‑ii trebuie informaţi la livrarea F0.", "task":"Slack webhook announce.","dirs":["/scripts/"] ,"constraints":"Webhook Slack în script `notify_slack.sh`; commit `ops(notify): slack f0`.", "output":"message"}
  {"step":98,"scope":"roadmap-update","context":"Documentul recap F0 (step 54) trebuie actualizat la 100 %.", "task":"docs/F0_foundation.md mark done.","dirs":["/docs/"] ,"constraints":"Marcarea status DONE; commit `docs(f0): mark done`.", "output":"doc"}
  {"step":99,"scope":"docs-graph","context":"Graficul de dependenţe s‑a modificat după ultimele proiecte.", "task":"Update graph.svg.","dirs":["/docs/"] ,"constraints":"Rulare `pnpm nx graph --file docs/graph.svg`; commit `docs(graph): update`.", "output":"graph"}
  {"step":100,"scope":"handover","context":"Handover complet lipseşte pentru echipa Ops.", "task":"docs/handovers/F0_handover.md.","dirs":["/docs/handovers/"] ,"constraints":"Template conţine: context, instrucţiuni runbook, contact rotaţie; commit `docs(handovers): f0`.", "output":"handover"  }
  {"step":101,"scope":"ci-tflint","context":"Terraform code crește; lipsesc verificări statice de stil.","task":"Adaugă job TFLint în CI (terraform-scan) pentru directoarele infra/terraform/**.","dirs":["/.github/workflows/ci-template.yml"],"constraints":"rule fail-on-warn true.","output":"TFLint job verde"},
  {"step":102,"scope":"ci-yamllint","context":"Manifestele YAML nu sunt validate.","task":"Adaugă job yamllint în CI pentru fișiere .yaml/.yml (exclude charts/).","dirs":["/.github/workflows/ci-template.yml"],"constraints":"config strict.","output":"yamllint job"},
  {"step":103,"scope":"mtls-canary-deployment","context":"mTLS permissive rulează stabil (step 37-40); necesară tranziție graduală la STRICT pentru zero downtime.","task":"Implementează canary deployment cu mTLS STRICT pentru 10% trafic în namespace gateway folosind VirtualService și DestinationRule. Monitorizează error rate și latency în Grafana.","dirs":["/core/infra/k8s/istio/","/core/infra/grafana/provisioning/dashboards/"],"constraints":"rollback automat dacă error rate > 1%; monitoring 2h; istioctl verify-install; commit 'feat(mtls): canary 10%'","output":"10% trafic mTLS STRICT validat"},
  {"step":104,"scope":"mtls-gradual-expansion","context":"Canary 10% mTLS STRICT stabil (step 103).","task":"Extinde mTLS STRICT la 50% din trafic folosind Istio traffic splitting. Configurează monitoring pentru all services și validează că toate comunicările interne funcționează corect.","dirs":["/core/infra/k8s/istio/","/core/infra/monitoring/"],"constraints":"monitor 24h; Service-to-service communication tests; zero failed requests; commit 'feat(mtls): expand 50%'","output":"50% trafic mTLS STRICT, comunicații validate"},
  {"step":105,"scope":"mtls-dependency-mapping","context":"50% trafic mTLS STRICT funcțional; necesară mapare completă dependențe pentru 100% rollout.","task":"Creează service dependency map folosind Kiali și identifică serviciile care nu suportă încă mTLS STRICT. Remediază problemele de compatibilitate și configurează fallback pentru legacy services.","dirs":["/core/infra/k8s/kiali/","/core/infra/policies/mtls/"],"constraints":"Use Kiali for visualization; dokumentează legacy services; compatibility matrix; commit 'feat(mtls): dependency mapping'","output":"dependency map completă, compatibilitate validată"},
  {"step":106,"scope":"gatekeeper-policy-skel","context":"Gatekeeper rule-base este gol.","task":"Creează infra/policies/opa cu ConstraintTemplate CTNotLatestTag.yaml și Constraint NotLatestTag.yaml care interzic imagini :latest.","dirs":["/core/infra/policies/opa/"] ,"constraints":"Mode warn in dev.","output":"OPA templates"},
  {"step":107,"scope":"external-secrets-sync-test","context":"ESO rulează fără validare.","task":"Creează ExternalSecret grafana-admin.yaml pentru secret grafana/admin/dev din AWS SecretsManager.","dirs":["/core/infra/k8s/"] ,"constraints":"Namespace observability.","output":"Secret sincronizat"},
  {"step":108,"scope":"istio-ca-rotate","context":"mTLS gradual deployment completat (steps 103-105); dependency mapping validat; ready pentru CA rotation și STRICT final.","task":"Importă CA corporativă (`mesh-ca-tls`), rotește Issuer `mesh-ca` cu noua CA; aplică PeerAuthentication STRICT pe toate namespace-urile. Monitorizează rollout și execută fallback la PERMISSIVE dacă detectează probleme.","dirs":["/core/infra/k8s/"],"constraints":"Zero downtime: istioctl verify-install; monitorizare continuă; rollback plan ready; commit 'feat(mtls): CA rotation + STRICT final'","output":"CA oficială activă, mTLS STRICT complet, zero downtime"},
  {"step":109,"scope":"cert-rotation-cronjob","context":"Rotația certificatelor lipsă.","task":"Adaugă CronJob rotate-certs care rulează cert-manager renew pentru namespace gateway la 30 zile.","dirs":["/core/infra/k8s/"] ,"constraints":"schedule */30 * * *.","output":"CronJob definit"},
  {"step":110,"scope":"scripts-worker-registry","context":"Admin Core va consuma registry","task":"Generează `scripts/update-worker-registry.py` + cron YAML dev","dirs":["/scripts/", "/infra/k8s/"],"constraints":"commit 'feat(script): worker-registry cron'","output":"script & cron live"},
  {"step":111,"scope":"packages-sdk-skel","context":"SDK‑urile lipsesc","task":"nx g @nx/js:library sdk-ts && nx g @nx/js:library sdk-py","dirs":["/packages/"],"constraints":"commit 'feat(packages): sdk skeletons'","output":"pachete goale create"},
  
  // 📊 OBSERVABILITATE FOUNDATION (109-115)
  {"step":112,"scope":"grafana-tenant-datasources","context":"Multi-tenant data sources pentru Grafana lipsesc.","task":"Configurează data sources Grafana pentru multi-tenancy: separate Prometheus queries per TID, Loki data source cu tenant filtering, Tempo tenant isolation configuration.","dirs":["/infra/grafana/provisioning/datasources/"],"constraints":"tenant isolation; security boundaries; performance optimization","output":"data sources multi-tenant Grafana"},
  {"step":113,"scope":"grafana-global-dashboards","context":"Global overview dashboards lipsesc.","task":"Creează dashboards globale Grafana: Cluster Health Overview, Multi-Tenant Resource Usage, Platform SLO Summary, Security Monitoring, Infrastructure Status.","dirs":["/infra/grafana/provisioning/dashboards/"],"constraints":"high-level executive view; cluster-wide perspective; security focus","output":"dashboards globale Grafana"},
  {"step":114,"scope":"alertmanager-routing-matrix","context":"Alert routing matrix pentru escalation lipsește.","task":"Configurează alert routing matrix în Alertmanager: severity-based routing, team-specific escalations, on-call schedules, cross-module dependency alerts routing.","dirs":["/infra/k8s/alertmanager/"],"constraints":"comprehensive escalation matrix; team boundaries; business impact routing","output":"alert routing matrix complete"},
  {"step":115,"scope":"prometheus-federation","context":"Prometheus federation pentru scalability lipsește.","task":"Configurează Prometheus federation: central Prometheus pentru cluster metrics, federated instances pentru module-specific metrics, retention policies per importance.","dirs":["/infra/helm/kube-prometheus-stack/"],"constraints":"scalability focus; retention optimization; query performance","output":"Prometheus federation active"},
  {"step":116,"scope":"loki-tenant-isolation","context":"Loki tenant isolation strict lipsește.","task":"Configurează Loki tenant isolation: tenant-based ingestion, query isolation per TID, retention policies per tenant, log anonymization for cross-tenant debugging.","dirs":["/infra/helm/loki/"],"constraints":"strict tenant isolation; GDPR compliant; debug capabilities","output":"Loki tenant isolation strict"},
  {"step":117,"scope":"tempo-cross-module-tracing","context":"Cross-module tracing correlation lipsește.","task":"Configurează Tempo pentru cross-module tracing: trace correlation între Vettify→ANAF, Sales→Workers, iWMS→Procurement, span metrics pentru business flows.","dirs":["/infra/helm/tempo/"],"constraints":"business flow tracing; performance correlation; cross-service debugging","output":"Tempo cross-module tracing"},
  {"step":118,"scope":"observability-slo-infrastructure","context":"Infrastructure SLO monitoring lipsește.","task":"Definește și monitorizează Infrastructure SLO: cluster uptime > 99.9%, storage IOPS performance, network latency targets, service mesh performance, backup success rates.","dirs":["/infra/grafana/provisioning/dashboards/","/infra/k8s/alertmanager/rules/"],"constraints":"infrastructure reliability targets; business continuity focus; operational excellence","output":"Infrastructure SLO definite"},
  
  // 🔐 CI/CD SECURITATE ȘI DEPLOYMENT STANDARDIZAT (116-122)
  {"step":119,"scope":"trivy-scanner-global","context":"Trivy scans inconsistent între module.","task":"Configurează Trivy scanner global pentru toate imaginile: setup registry scanning, definește praguri standardizate CRITICAL=0, HIGH≤3, MEDIUM≤15, configurează bypass policy pentru dev.","dirs":["/infra/k8s/trivy/","/infra/policies/"],"constraints":"fail pipeline pe CRITICAL; weekly registry scans; OPA policy pentru exceptions; standard global aplicat","output":"Trivy scanner global standardizat cu praguri uniforme"},
  {"step":120,"scope":"github-actions-template","context":"CI/CD pipeline template lipsește.","task":"Creează template GitHub Actions cu security scanning standard: Trivy pentru containers, SAST pentru cod, dependency check, license scanning, SBOM generation.","dirs":["/.github/workflows/templates/"],"constraints":"template reusable; security gate mandatory; artifact attestation","output":"CI/CD template securizat"},
  {"step":121,"scope":"canary-deployment-infra","context":"Canary deployment infrastructure lipsește.","task":"Setup infrastructure pentru canary deployments: Argo Rollouts controller, Istio service mesh pentru traffic splitting, Prometheus pentru metrics analysis.","dirs":["/infra/helm/argo-rollouts/","/infra/helm/istio/"],"constraints":"traffic split 10%→50%→100%; automated rollback; success rate metrics","output":"canary deployment infrastructure"},
  {"step":122,"scope":"canary-metrics-analysis","context":"Canary metrics analysis standardizat lipsește.","task":"Configurează analysis template pentru canary: success rate > 99%, latency p95 < 250ms, error rate < 1%, custom business metrics per module.","dirs":["/infra/k8s/argo-rollouts/","/infra/grafana/provisioning/"],"constraints":"automated rollback triggers; 1h analysis window; Prometheus queries","output":"canary metrics analysis standard"},
  {"step":123,"scope":"cosign-signing-infrastructure","context":"Cosign signing infrastructure centralizată lipsește.","task":"Setup Cosign signing infrastructure: KMS integration pentru key management, OCI registry configuration, policy controller pentru verify, SBOM attestation.","dirs":["/infra/k8s/cosign/","/infra/policies/cosign/"],"constraints":"automated signing în CI; policy enforcement; key rotation; compliance logging","output":"Cosign infrastructure centralizată"},
  {"step":124,"scope":"deployment-health-checks","context":"Health checks standardizate pentru deployment lipsesc.","task":"Definește health check template pentru toate serviciile: readiness/liveness probes, startup probes pentru slow services, traffic readiness verification.","dirs":["/infra/helm/templates/","/infra/k8s/health-checks/"],"constraints":"standardized across all modules; business logic health; dependency checks","output":"health checks standardizate"},
  {"step":125,"scope":"rollback-automation","context":"Rollback automation standardizat lipsește.","task":"Implementează rollback automation: detect failure patterns, automated rollback triggers, notification system, post-rollback verification, incident creation.","dirs":["/infra/k8s/argo-rollouts/","/infra/k8s/alertmanager/"],"constraints":"business continuity focus; < 5min rollback time; automated incident creation","output":"rollback automation complet"}

]

```
